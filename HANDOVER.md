# 项目交接文档 (HANDOVER) - 2026-02-23

## 项目定位
- **项目名称**: CTS1 (Crypto Trade Squad)
- **当前版本**: V2.4-ULTRA
- **环境**: OKX 模拟盘 (Demo Trading) + Python 实时交易引擎 + Flask 监控看板

## 1. 已完成任务 (Recently Completed)

### [2026-02-23] OKX API 认证与状态同步修复
- **401 错误修复**: 修正了 `okx_config.py` 中的签名算法。现在签名路径已包含 GET 查询参数，且 POST Body 序列化逻辑已与官方服务器同步。
- **资产实时同步**: 实现了每 5 分钟从 OKX 云端拉取真实余额（当前: 3000 USDT）和真实持仓。
- **下单链路打通**: 验证了下单请求已能成功穿透身份认证层，进入 OKX 服务器业务逻辑处理。

### [2026-02-23] 看板增强与环境修复
- **K 线实时渲染**: 修复了 Dashboard 的 K 线组件数据异常问题。
- **环境依赖**: 解决了 Playwright 环境下的脚本运行问题和后端依赖冲突。
- **代码结构**: 完成了代码规范化清理，将所有硬编码逻辑抽离至模块化文件。

## 2. 当前运行状态

- **API 状态**: 正常 (已认证)
- **资金池**: OKX 云端模拟盘余额 (3000 USDT)
- **引擎状态**: 正在运行 (`run_live_grid.py`)。它正在订阅 K 线，计算 RSI 指标，并驱动动态网格。
- **看板**: `http://localhost:5000` 正常显示实时行情、资产及 PnL 曲线。

## 3. 后续工作计划 (Planned Tasks)

### P0: 深度对接模拟盘下单 (Force Server Mode)
- **目标**: 目前大部分“自动网格”仍处于本地滑动点模拟成交模式。需将 `grid_strategy.py` 中的成交逻辑完全切换为发送真实订单到 OKX（即设置 `force_server=True`）。
- **挑战**: 需适配交易所最小下单量限制（51020 报错处理）。

### P1: 策略鲁棒性优化
- **仓位计算**: 改进凯利公式计算结果，确保生成的 `sz`（数量）满足交易所的精度和最小起步价。
- **异常恢复**: 增加余额突变自动重置策略的逻辑。

### P2: UI 交互与清理
- **控制面板**: 在 Dashboard 上增加“手动刷新余额”和“强制平仓/重置网格”按钮。
- **文件清理**: 删除 `generate_mock_data.py` 等旧版占位脚本，保持根目录整洁。

---
*Generated by Antigravity @ 2026-02-23 21:40*
